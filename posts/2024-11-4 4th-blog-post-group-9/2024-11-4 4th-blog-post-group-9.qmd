---
title: "4th blog post group 9"
author: "Group 9"
date: "2024-11-4"
date-modified: "2024-11-4"
draft: FALSE
---

While cleaning the data, there was one specific variable, the revenue, which has way more NA values in it than any other variables. However, as a very significant numerical variable, it would be a pretty big loss to the data set if we really completely ignore this variable and let it go. As a result, two sets of cleaned data was presented, one with the revenues presented but as a result of data cleaning, there are only 16879 data points left, and one without without the revenue variable to provide more information about all other variables, and as a result, has 43575 data points left.

After all works done, the data has seven categorical variables, which includes the sector of industry of the company, the sex label, the ethical group label, the race label, the veteran label, the time company has been in the industry and the year that data was collected. There are also three numerical variables including the number of employers, the number of employees and their payrolls. The standard error for those variables are also included. In one of the data sets, the revenue and standard error for the revenue is also included.

data <- readRDS(here::here("dataset/cleaned_data_N_revenue.rds"))

data

# Basic data exploration
str(data)
summary(data)


## Average Employment Trends by Race

library(ggplot2)
library(dplyr)
library(scales)

# Function to format numbers in millions
format_m <- function(x) {
  paste0(round(x/1000000, 1), "M")
}

# Employment trends by race
data %>%
  filter(!RACE_GROUP_LABEL %in% c("Total", "Unclassifiable", "Classifiable")) %>%
  group_by(YEAR, RACE_GROUP_LABEL) %>%
  summarise(avg_employment = mean(EMP), .groups = 'drop') %>%
  ggplot(aes(x = YEAR, y = avg_employment, color = RACE_GROUP_LABEL)) +
  geom_line(linewidth = 1) +
  geom_point(size = 3, alpha = 0.8) +
  theme_minimal() +
  labs(title = "Average Employment Trends by Race",
       subtitle = "Excluding Total, Unclassifiable, and Classifiable categories",
       x = "Year",
       y = "Average Number of Employees (M)",
       color = "Race") +
  scale_y_continuous(labels = format_m) +
  theme(legend.position = "bottom",
        legend.text = element_text(size = 8),
        panel.grid.minor = element_blank())

In this table we are able to see the average employment trends by race. The trend starts in 2017 and ends in 2021. While most race categories during this time remain below the 1 million average number mark, the White and Non-minority race categories quickly rise in the first year and remain fairly stagnant at about the 4 million average employee mark. All other races either remain very low in average employee count or grow slightly. These other numbers also stagnated at their lower average numbers. 
